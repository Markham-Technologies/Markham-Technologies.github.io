"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[814],{2814:function(e,t,n){n.r(t),n.d(t,{default:function(){return A}});var r=n(7437),a=n(2265),s=n(759),i=n.n(s);n(5046),n(4840),n(9003);var l=n(6070),o=n(2869),c=n(4508);let d=a.forwardRef((e,t)=>{let{className:n,type:a,...s}=e;return(0,r.jsx)("input",{type:a,className:(0,c.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),ref:t,...s})});d.displayName="Input";var u=n(268);let m=u.fC,f=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)(u.aV,{ref:t,className:(0,c.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",n),...a})});f.displayName=u.aV.displayName;let g=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)(u.xz,{ref:t,className:(0,c.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",n),...a})});g.displayName=u.xz.displayName,a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)(u.VY,{ref:t,className:(0,c.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",n),...a})}).displayName=u.VY.displayName;var h=n(8091),x=n(9043),p=n(665),v=n(6811),b=n(8221);let N={"Astley Crossroads":[52.49945497475586,-1.5426958044405223],"Fillongley Crossroads":[52.482863378276384,-1.5884007632946056],"Green End Rd E":[52.47920122150007,-1.5976663571929843],"Green End Rd W":[52.47927032178863,-1.6491568374856456],"Packington Ln N":[52.47283063473509,-1.6528727587647702],"Maxstoke Ln S":[52.43959955817817,-1.6538403966088495],"Fillongley Rd S":[52.44207483093465,-1.6364109519958472],"Wall Hill Rd W":[52.466302642788776,-1.6044106230489792],"Common Ln W":[52.46214169209281,-1.5905654577242356],"New End Rd S":[52.4807852835353,-1.658440174605306],"New End Rd N":[52.490294497565756,-1.6579629544729697],"Breach Oak Ln N":[52.498415321180055,-1.5399989218288552],"Breach Oak Ln S":[52.47297029601229,-1.5458421078492464],"Rock Ln W":[52.46196581019906,-1.5560349333966925],"Rock Ln E":[52.46891715809801,-1.5512325153540953],"Church Ln E":[52.46359720652995,-1.5574850120735446],"Tamworth Rd S":[52.43618652005914,-1.5322320697347118],"Wood End Crossroads":[52.490174551572366,-1.5704409574702962],"Astley Ln W":[52.482433051390764,-1.5674146676017437],"Beach Oak Ln Split":[52.48104628934318,-1.54916067468626],"Bedworth Ln E":[52.485352132099315,-1.5158719339145317],"Heath Rd S":[52.47818267505538,-1.4915754481998094],"Smorral Ln E":[52.476269807232235,-1.5149115155650577],"Nuthurst Ln N":[52.51647122647738,-1.5528253062855033],"Nuthurst Ln S":[52.50202693954895,-1.5448178757810567],"Astley Ln N":[52.515158462631405,-1.5126402919420145],"[A444] Vicarage St S":[52.52098305234558,-1.466483298190452],"[A444] Vicarage St N":[52.52407435862613,-1.46370956044206],"[A444] Coton Rd S":[52.51536947794826,-1.467280816043945],"[A444] Coton Rd N":[52.52033953445266,-1.4672966352889294],"[A444] Chilvers Rise S":[52.51257143060584,-1.471444333696481],"[A444] Chilvers Rise N":[52.51404139053653,-1.4693979231906573],"[A444] Griff Way S":[52.49942067835656,-1.4741412139113983],"[A444] Griff Way N":[52.51171955845734,-1.4723810042894079],"[A444] Bedworth S":[52.466489593778654,-1.4912150330034748],"[A444] Bedworth N":[52.49309953018232,-1.4806107129445507],"[A444] Trade Centre UK N":[52.459268147697045,-1.4971894878726875],"[A444] Trade Centre UK S":[52.45000692815442,-1.499839089882825],"[A444] Coventry Arena N":[52.448018514147904,-1.4984992595592084],"[A444] Coventry Arena S":[52.439953412078424,-1.4998505950616643],"[A444] Arena Spur N":[52.438750250969804,-1.4993646128277234],"[A444] Arena Spur S":[52.4308181598632,-1.4863509793094012],"[A444] AT7 Centre N":[52.42987062664605,-1.484930098885678],"[A444] AT7 Centre S":[52.422992724198814,-1.4867507316742594],"[A444] Euro Car Parts N":[52.42166587049689,-1.48688124909937],"[A444] Euro Car Parts S":[52.40768149333183,-1.4880457518515318],"Sky Blue Way E":[52.40717192727136,-1.4889174571385377],"Sky Blue Way W":[52.407962918764596,-1.4976781442252562],"Breach Oak Ln M":[52.47535616973605,-1.5445734079393956],"[M6] Corley Services":[52.47087569059111,-1.5399509247260206],"[M6] J3 Bedworth N":[52.4662583209609,-1.5062800525751818],"[M6] J3 Bedworth S":[52.45865391420982,-1.4838809429825817],"Walsingham Dr S":[52.4974753044914,-1.4809973680931239],"Walsingham Dr Rb S":[52.50108857253609,-1.4821667143839903],"Walsingham Dr Rb N":[52.49778245612305,-1.481098672345678],"Walsingham Dr TC Split":[52.50320604861628,-1.4854104690653307],"Carnation Way W":[52.50454546738215,-1.4852844079213572]},y="https://api.pastee.dev/v1/pastes";function j(){return localStorage.getItem("pasteee_api_key")||void 0}async function w(e,t,n){let r=e;if(t)try{let n=await S(t);r=function(e,t){let n={};return[...e,...t].forEach(e=>{let t="".concat(e.from,"->").concat(e.to);(!n[t]||e.time<n[t].time)&&(n[t]=e)}),Object.values(n)}(n,e)}catch(t){r=e}let a=new Headers;a.append("Content-Type","application/json");let s=n||j();s&&a.append("X-Auth-Token",s);let i=await fetch(y,{method:"POST",headers:a,body:JSON.stringify({description:"Racing segment times",sections:[{name:"Times",syntax:"json",contents:JSON.stringify(r)}],encrypted:!1,expire:"never"})});if(!i.ok)throw Error("Failed to save times to Paste.ee");return(await i.json()).id}async function S(e,t){let n=new Headers,r=t||j();r&&n.append("X-Auth-Token",r);let a=await fetch("".concat(y,"/").concat(e),{headers:n});if(!a.ok)throw Error("Failed to load times from Paste.ee");return JSON.parse((await a.json()).paste.sections[0].contents)}function k(e){return"data:image/svg+xml;base64,".concat(btoa('\n    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="'.concat(e,'">\n      <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5S10.62 6.5 12 6.5s2.5 1.12 2.5 2.5S13.38 11.5 12 11.5z"/>\n    </svg>\n  ')))}function A(){let e=(0,a.useRef)(null),t=(0,a.useRef)(null),n=(0,a.useRef)(null),[s,c]=(0,a.useState)({lat:52.42520983749512,lng:-1.517116308101305}),[u,y]=(0,a.useState)([]),[j,A]=(0,a.useState)([]),[C,R]=(0,a.useState)(null),[E]=(0,a.useState)(()=>Date.now()),[L,T]=(0,a.useState)(!1),[W,M]=(0,a.useState)(null),[P,z]=(0,a.useState)(localStorage.getItem("pasteee_api_key")||""),[B,I]=(0,a.useState)([]),[O,_]=(0,a.useState)(!1),[F,V]=(0,a.useState)("route"),D=(0,a.useRef)(u);async function Z(){T(!0),M(null);try{let e=await w(B,C||void 0,P||void 0);R(e);let t=await S(e,P||void 0);A(t),alert("Saved! Your Save ID: "+e)}catch(e){M(e.message)}T(!1)}async function H(){let e=prompt("Enter Save ID to load:",C||"");if(e){T(!0),M(null);try{let t=await S(e,P||void 0);A(t),R(e)}catch(e){M(e.message)}T(!1)}}let Y=i().icon({iconUrl:k("#000000FF"),iconSize:[32,32],iconAnchor:[16,32]}),G=i().icon({iconUrl:k("#ce0000ff"),iconSize:[32,32],iconAnchor:[16,32]});async function J(e){T(!0),M(null);try{let t=await S(e,P||void 0);A(t)}catch(e){M(e.message)}T(!1)}function K(e,t){Object.entries(N).forEach(n=>{let[r,a]=n;if(Array.isArray(a)&&2===a.length){let[n,s]=a;if(50>=function(e,t,n,r){let a=(n-e)*Math.PI/180,s=(r-t)*Math.PI/180,i=Math.sin(a/2)*Math.sin(a/2)+Math.cos(e*Math.PI/180)*Math.cos(n*Math.PI/180)*Math.sin(s/2)*Math.sin(s/2);return 2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i))*6371e3}(e,t,n,s)){let e=(Date.now()-E)/1e3;if(D.current.length>0){let t=D.current[D.current.length-1];r!==t.road&&I(n=>[...n,{from:t.road,to:r,time:e-t.time}])}y(t=>[...t,{road:r,time:e}])}}})}return(0,a.useEffect)(()=>{if(!e.current||t.current)return;let n=i().map(e.current).setView([52.42520983749512,-1.517116308101305],15);t.current=n,i().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(n),n.on("dragstart",()=>_(!0)),n.on("zoomstart",()=>_(!0))},[]),(0,a.useEffect)(()=>{if(!t.current)return;let e=t.current;n.current&&e.removeLayer(n.current);let r=i().layerGroup();Object.entries(N).forEach(e=>{let[t,n]=e;if(Array.isArray(n)&&2===n.length){let[e,a]=n;i().marker([e,a],{icon:Y}).addTo(r).bindPopup(t)}});s&&i().marker([s.lat,s.lng],{icon:G,draggable:!0}).addTo(r).bindPopup("Current Location").on("moveend",e=>{let{lat:t,lng:n}=e.target.getLatLng();c({lat:t,lng:n}),_(!0),K(t,n)}),r.addTo(e),n.current=r},[s,u,E,Y,G]),(0,a.useEffect)(()=>{let e=localStorage.getItem("racing_pasteee_save_id");e&&!C&&(R(e),J(e))},[]),(0,a.useEffect)(()=>{C&&localStorage.setItem("racing_pasteee_save_id",C)},[C]),(0,a.useEffect)(()=>{D.current=u},[u]),(0,a.useEffect)(()=>{let e=null;return navigator.geolocation&&(e=navigator.geolocation.watchPosition(e=>{c({lat:e.coords.latitude,lng:e.coords.longitude}),K(e.coords.latitude,e.coords.longitude),t.current&&!O&&t.current.setView([e.coords.latitude,e.coords.longitude],t.current.getZoom())},()=>{c({lat:52.42520983749512,lng:-1.517116308101305}),K(52.42520983749512,-1.517116308101305),t.current&&!O&&t.current.setView([52.42520983749512,-1.517116308101305],t.current.getZoom())},{enableHighAccuracy:!0,maximumAge:1e3,timeout:1e4})),()=>{null!==e&&navigator.geolocation&&navigator.geolocation.clearWatch(e)}},[O]),(0,r.jsxs)("div",{className:"container relative flex flex-col",style:{paddingBottom:32},children:[(0,r.jsx)("div",{className:"flex flex-row items-center gap-2 mt-6 mb-2"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",style:{height:"70vh",minHeight:400},children:[(0,r.jsxs)(l.Zb,{className:"md:col-span-1 h-full min-h-0 flex flex-col",children:[(0,r.jsxs)(l.Ol,{children:[(0,r.jsx)(m,{value:F,onValueChange:V,className:"mb-4",children:(0,r.jsxs)(f,{children:[(0,r.jsx)(g,{value:"route",children:"Route Time"}),(0,r.jsx)(g,{value:"settings",children:"Settings"})]})}),"route"===F&&(0,r.jsx)(l.ll,{children:(0,r.jsxs)("span",{className:"inline-flex items-center align-middle",children:[(0,r.jsx)(h.Z,{className:"mr-2 h-6 w-6 align-middle"}),(0,r.jsx)("span",{className:"align-middle",children:"Route Time"})]})}),"settings"===F&&(0,r.jsx)(l.ll,{children:(0,r.jsxs)("span",{className:"inline-flex items-center align-middle",children:[(0,r.jsx)(x.Z,{className:"mr-2 h-6 w-6 align-middle"}),(0,r.jsx)("span",{className:"align-middle",children:"Settings"})]})})]}),W&&(0,r.jsx)("div",{className:"text-red-500 text-xs ml-2",children:W}),"route"===F&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.aY,{className:"flex-1 min-h-0 overflow-auto",children:s?(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-semibold mb-1",children:"Segment Times"}),(0,r.jsxs)("ol",{className:"text-xs",children:[0===B.length&&(0,r.jsx)("li",{className:"text-muted-foreground",children:"No segments completed yet."}),B.map((e,t)=>{let n=j.find(t=>t.from===e.from&&t.to===e.to),a=n&&e.time<n.time;return(0,r.jsxs)("li",{className:"mb-1",children:[(0,r.jsxs)("span",{className:"font-semibold",children:[e.from," → ",e.to]}),(0,r.jsxs)("span",{className:"ml-2 text-blue-600",children:[e.time.toFixed(2),"s"]}),n&&(0,r.jsxs)("span",{className:"ml-2 text-xs ".concat(a?"text-green-600 font-bold":"text-green-600"),children:["(Best: ",n.time.toFixed(2),"s",a?" - New PB!":"",")"]})]},t)})]})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("p",{className:"text-sm font-semibold mb-1",children:"Best Segment Times"}),(0,r.jsxs)("ol",{className:"text-xs",children:[0===j.length&&(0,r.jsx)("li",{className:"text-muted-foreground",children:"No best segments yet."}),j.map((e,t)=>(0,r.jsxs)("li",{className:"mb-1",children:[(0,r.jsxs)("span",{className:"font-semibold",children:[e.from," → ",e.to]}),(0,r.jsxs)("span",{className:"ml-2 text-green-600",children:[e.time.toFixed(2),"s"]})]},t))]})]})]}):(0,r.jsx)("p",{className:"text-muted-foreground",children:"Locating..."})}),(0,r.jsx)(l.aY,{children:(0,r.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,r.jsxs)(o.z,{variant:"outline",onClick:Z,disabled:L,size:"sm",children:[(0,r.jsx)(p.Z,{className:"mr-2 h-4 w-4"})," Save Times"]}),(0,r.jsxs)(o.z,{variant:"outline",onClick:H,disabled:L,size:"sm",children:[(0,r.jsx)(v.Z,{className:"mr-2 h-4 w-4"})," Load Times"]})]})})]}),"settings"===F&&(0,r.jsx)(l.aY,{className:"flex-1 min-h-0 overflow-auto",children:(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"pasteee-save-id",className:"mb-1 font-semibold text-xs uppercase tracking-wider block",children:"Paste.ee Save ID"}),(0,r.jsx)(d,{id:"pasteee-save-id",type:"text",value:C||"",onChange:e=>R(e.target.value),className:"w-full border rounded px-2 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Paste.ee Save ID"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"pasteee-api-key",className:"mb-1 font-semibold text-xs uppercase tracking-wider block",children:"Paste.ee API Key"}),(0,r.jsx)(d,{id:"pasteee-api-key",type:"password",value:P,onChange:e=>z(e.target.value),placeholder:"Paste.ee API Key"})]}),(0,r.jsxs)("div",{className:"flex flex-row gap-4 items-center font-semibold text-xs uppercase tracking-wider block",children:[(0,r.jsx)("span",{children:"Latitude:"}),(0,r.jsx)("span",{className:"text-muted-foreground",children:s?s.lat:"Locating..."})]}),(0,r.jsxs)("div",{className:"flex flex-row gap-4 items-center font-semibold text-xs uppercase tracking-wider block",children:[(0,r.jsx)("span",{children:"Longitude:"}),(0,r.jsx)("span",{className:"text-muted-foreground",children:s?s.lng:"Locating..."})]})]})})]}),(0,r.jsx)("div",{className:"md:col-span-2 h-full min-h-0 flex-1 rounded-md overflow-hidden border relative",style:{position:"relative"},ref:e,children:(0,r.jsx)("div",{style:{position:"absolute",top:8,right:8,zIndex:1e4,pointerEvents:"auto"},children:(0,r.jsxs)(o.z,{variant:"outline",onClick:()=>{_(!1),t.current&&s&&t.current.setView([s.lat,s.lng],t.current.getZoom())},className:"btn btn-sm btn-accent shadow",style:{minWidth:90},children:[(0,r.jsx)(b.Z,{className:"mr-2 h-4 w-4"})," Re-center"]})})})]})]})}},2869:function(e,t,n){n.d(t,{z:function(){return c}});var r=n(7437),a=n(2265),s=n(7053),i=n(7712),l=n(4508);let o=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:n,variant:a,size:i,asChild:c=!1,...d}=e,u=c?s.g7:"button";return(0,r.jsx)(u,{className:(0,l.cn)(o({variant:a,size:i,className:n})),ref:t,...d})});c.displayName="Button"},6070:function(e,t,n){n.d(t,{Ol:function(){return l},Zb:function(){return i},aY:function(){return c},ll:function(){return o}});var r=n(7437),a=n(2265),s=n(4508);let i=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",n),...a})});i.displayName="Card";let l=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",n),...a})});l.displayName="CardHeader";let o=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("h3",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",n),...a})});o.displayName="CardTitle",a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("p",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",n),...a})}).displayName="CardDescription";let c=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",n),...a})});c.displayName="CardContent",a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",n),...a})}).displayName="CardFooter"},4508:function(e,t,n){n.d(t,{cn:function(){return s}});var r=n(1994),a=n(3335);function s(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,a.m6)((0,r.W)(t))}}}]);