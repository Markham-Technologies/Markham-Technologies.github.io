"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[674],{2210:function(e,t,a){a.r(t),a.d(t,{default:function(){return x}});var n=a(3827),s=a(4090),r=a(6461),l=a.n(r);a(9851),a(8203),a(8180);var o=a(7815);function i(e){let{pasteId:t,apiKey:a,setApiKey:r}=e,[l,o]=s.useState(!1);return(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsxs)("button",{className:"btn btn-xs btn-ghost border border-muted rounded px-2 py-1 flex items-center gap-1",onClick:()=>o(e=>!e),"aria-label":"Settings",type:"button",children:[(0,n.jsx)("span",{className:"material-symbols-outlined text-base align-middle",children:"settings"}),(0,n.jsx)("span",{className:"text-xs",children:"Settings"})]}),l&&(0,n.jsxs)("div",{className:"absolute z-20 mt-2 right-0 bg-white dark:bg-neutral-900 border rounded shadow p-4 min-w-[220px]",children:[(0,n.jsxs)("div",{className:"mb-2",children:[(0,n.jsx)("label",{className:"block text-xs font-semibold mb-1",children:"Paste.ee API Key"}),(0,n.jsx)("input",{type:"password",className:"input input-xs w-full",placeholder:"Paste.ee API Key (optional)",value:a,onChange:e=>{r(e.target.value),e.target.value?localStorage.setItem("pasteee_api_key",e.target.value):localStorage.removeItem("pasteee_api_key")}})]}),t&&(0,n.jsxs)("div",{className:"mb-2",children:[(0,n.jsx)("label",{className:"block text-xs font-semibold mb-1",children:"Save Pin"}),(0,n.jsx)("input",{type:"text",className:"input input-xs w-full bg-muted",value:t,readOnly:!0,onFocus:e=>e.currentTarget.select()})]}),(0,n.jsx)("button",{className:"btn btn-xs w-full mt-2",onClick:()=>o(!1),children:"Close"})]})]})}let c={"Astley Crossroads":[52.49945497475586,-1.5426958044405223],"Fillongley Crossroads":[52.482863378276384,-1.5884007632946056],"Green End Rd E":[52.47920122150007,-1.5976663571929843],"Green End Rd W":[52.47927032178863,-1.6491568374856456],"Packington Ln N":[52.47283063473509,-1.6528727587647702],"Maxstoke Ln S":[52.43959955817817,-1.6538403966088495],"Fillongley Rd S":[52.44207483093465,-1.6364109519958472],"Wall Hill Rd W":[52.466302642788776,-1.6044106230489792],"Common Ln W":[52.46214169209281,-1.5905654577242356],"New End Rd S":[52.4807852835353,-1.658440174605306],"New End Rd N":[52.490294497565756,-1.6579629544729697],"Breach Oak Ln N":[52.498415321180055,-1.5399989218288552],"Breach Oak Ln S":[52.47297029601229,-1.5458421078492464],"Rock Ln W":[52.46196581019906,-1.5560349333966925],"Rock Ln E":[52.46891715809801,-1.5512325153540953],"Church Ln E":[52.46359720652995,-1.5574850120735446],"Tamworth Rd S":[52.43618652005914,-1.5322320697347118],"Wood End Crossroads":[52.490174551572366,-1.5704409574702962],"Astley Ln W":[52.482433051390764,-1.5674146676017437],"Beach Oak Ln Split":[52.48104628934318,-1.54916067468626],"Bedworth Ln E":[52.485352132099315,-1.5158719339145317],"Heath Rd S":[52.47818267505538,-1.4915754481998094],"Smorral Ln E":[52.476269807232235,-1.5149115155650577],"Nuthurst Ln N":[52.51647122647738,-1.5528253062855033],"Nuthurst Ln S":[52.50202693954895,-1.5448178757810567],"Astley Ln N":[52.515158462631405,-1.5126402919420145],"A444 S":[52.466489593778654,-1.4912150330034748],"A444 N":[52.49309953018232,-1.4806107129445507],"Walsingham Dr S":[52.4974753044914,-1.4809973680931239],"Walsingham Dr N":[52.50108857253609,-1.4821667143839903],"[A444] Trade Centre UK N":[52.459268147697045,-1.4971894878726875],"[A444] Trade Centre UK S":[52.45000692815442,-1.499839089882825],"[A444] Coventry Arena N":[52.448018514147904,-1.4984992595592084],"[A444] Coventry Arena S":[52.439953412078424,-1.4998505950616643],"[A444] Arena Spur N":[52.438750250969804,-1.4993646128277234],"[A444] Arena Spur S":[52.4308181598632,-1.4863509793094012],"[A444] AT7 Centre N":[52.42987062664605,-1.484930098885678],"[A444] AT7 Centre S":[52.422992724198814,-1.4867507316742594],"[A444] Euro Car Parts N":[52.42166587049689,-1.48688124909937],"[A444] Euro Car Parts S":[52.40768149333183,-1.4880457518515318],"Sky Blue Way E":[52.40717192727136,-1.4889174571385377],"Sky Blue Way W":[52.407962918764596,-1.4976781442252562]},d="https://api.pastee.dev/v1/pastes";function m(){return localStorage.getItem("pasteee_api_key")||void 0}async function u(e,t,a){let n=e;if(t)try{let a=await f(t);n=function(e,t){let a={};return[...e,...t].forEach(e=>{let t="".concat(e.from,"->").concat(e.to);(!a[t]||e.time<a[t].time)&&(a[t]=e)}),Object.values(a)}(a,e)}catch(t){n=e}let s=new Headers;s.append("Content-Type","application/json");let r=a||m();r&&s.append("X-Auth-Token",r);let l=await fetch(d,{method:"POST",headers:s,body:JSON.stringify({description:"Racing segment times",sections:[{name:"Times",syntax:"json",contents:JSON.stringify(n)}],encrypted:!1,expire:"never"})});if(!l.ok)throw Error("Failed to save times to Paste.ee");return(await l.json()).id}async function f(e,t){let a=new Headers,n=t||m();n&&a.append("X-Auth-Token",n);let s=await fetch("".concat(d,"/").concat(e),{headers:a});if(!s.ok)throw Error("Failed to load times from Paste.ee");return JSON.parse((await s.json()).paste.sections[0].contents)}function h(e){return"data:image/svg+xml;base64,".concat(btoa('\n    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="'.concat(e,'">\n      <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5S10.62 6.5 12 6.5s2.5 1.12 2.5 2.5S13.38 11.5 12 11.5z"/>\n    </svg>\n  ')))}function x(){let e=(0,s.useRef)(null),t=(0,s.useRef)(null),a=(0,s.useRef)(null),[r,d]=(0,s.useState)({lat:52.475452,lng:-1.544527}),[m,x]=(0,s.useState)([]),[p,g]=(0,s.useState)([]),[N,b]=(0,s.useState)(null),[v]=(0,s.useState)(()=>Date.now()),[y,j]=(0,s.useState)(!1),[S,w]=(0,s.useState)(null),[A,k]=(0,s.useState)(localStorage.getItem("pasteee_api_key")||""),[C,E]=(0,s.useState)([]);async function L(){j(!0),w(null);try{let e=await u(C,N||void 0,A||void 0);b(e);let t=await f(e,A||void 0);g(t),alert("Saved! Your Save ID: "+e)}catch(e){w(e.message)}j(!1)}async function R(){let e=prompt("Enter Save ID to load:",N||"");if(e){j(!0),w(null);try{let t=await f(e,A||void 0);g(t),b(e)}catch(e){w(e.message)}j(!1)}}let T=l().icon({iconUrl:h("#000000FF"),iconSize:[32,32],iconAnchor:[16,32]}),P=l().icon({iconUrl:h("#ce0000ff"),iconSize:[32,32],iconAnchor:[16,32]});async function _(e){j(!0),w(null);try{let t=await f(e,A||void 0);g(t)}catch(e){w(e.message)}j(!1)}return(0,s.useEffect)(()=>{if(!e.current||t.current)return;let a=l().map(e.current).setView([52.5,-1.9],7);t.current=a,l().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(a)},[]),(0,s.useEffect)(()=>{if(!t.current)return;let e=t.current;a.current&&e.removeLayer(a.current);let n=l().layerGroup();Object.entries(c).forEach(e=>{let[t,a]=e;if(Array.isArray(a)&&2===a.length){let[e,s]=a;l().marker([e,s],{icon:T}).addTo(n).bindPopup(t)}});r&&l().marker([r.lat,r.lng],{icon:P,draggable:!0}).addTo(n).bindPopup("Current Location").on("moveend",e=>{let{lat:t,lng:a}=e.target.getLatLng();d({lat:t,lng:a}),Object.entries(c).forEach(e=>{let[n,s]=e;if(Array.isArray(s)&&2===s.length){let[e,r]=s;25>=function(e,t,a,n){let s=(a-e)*Math.PI/180,r=(n-t)*Math.PI/180,l=Math.sin(s/2)*Math.sin(s/2)+Math.cos(e*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);return 2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))*6371e3}(t,a,e,r)&&(E(e=>{let t=(Date.now()-v)/1e3;if(m.length>0){let a=m[m.length-1];return[...e,{from:a.road,to:n,time:t-a.time}]}return e}),x(e=>[...e,{road:n,time:(Date.now()-v)/1e3}]))}})}),n.addTo(e),a.current=n},[r,m,v,T,P]),(0,s.useEffect)(()=>{let e=localStorage.getItem("racing_pasteee_save_id");e&&!N&&(b(e),_(e))},[]),(0,s.useEffect)(()=>{N&&localStorage.setItem("racing_pasteee_save_id",N)},[N]),(0,s.useEffect)(()=>{let e=null;return navigator.geolocation&&(e=navigator.geolocation.watchPosition(e=>{d({lat:e.coords.latitude,lng:e.coords.longitude})},()=>{d({lat:52.42520983749512,lng:-1.517116308101305})},{enableHighAccuracy:!0,maximumAge:1e3,timeout:1e4})),()=>{null!==e&&navigator.geolocation&&navigator.geolocation.clearWatch(e)}},[]),(0,n.jsxs)("div",{className:"container relative flex flex-col",style:{paddingBottom:32},children:[(0,n.jsxs)("div",{className:"flex flex-row items-center gap-2 mt-6 mb-2",children:[(0,n.jsx)("button",{onClick:L,disabled:y,className:"btn btn-sm btn-primary",children:"Save Times"}),(0,n.jsx)("button",{onClick:R,disabled:y,className:"btn btn-sm btn-secondary",children:"Load Times"}),(0,n.jsx)(i,{pasteId:N,apiKey:A,setApiKey:k}),S&&(0,n.jsx)("div",{className:"text-red-500 text-xs ml-2",children:S})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",style:{height:"70vh",minHeight:400},children:[(0,n.jsxs)(o.Zb,{className:"md:col-span-1 h-full min-h-0 flex flex-col",children:[(0,n.jsx)(o.Ol,{children:(0,n.jsx)(o.ll,{children:"⏱️ Route Time"})}),(0,n.jsx)(o.aY,{className:"flex-1 min-h-0 overflow-auto",children:r?(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"mb-2 flex flex-row gap-4 items-center",children:[(0,n.jsx)("span",{className:"text-sm font-semibold",children:"Lat:"}),(0,n.jsx)("span",{className:"text-muted-foreground",children:r.lat.toFixed(6)}),(0,n.jsx)("span",{className:"text-sm font-semibold ml-4",children:"Lng:"}),(0,n.jsx)("span",{className:"text-muted-foreground",children:r.lng.toFixed(6)})]}),(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)("p",{className:"text-sm font-semibold mb-1",children:"Segment Times"}),(0,n.jsxs)("ol",{className:"text-xs",children:[0===C.length&&(0,n.jsx)("li",{className:"text-muted-foreground",children:"No segments completed yet."}),C.map((e,t)=>{let a=p.find(t=>t.from===e.from&&t.to===e.to),s=a&&e.time<a.time;return(0,n.jsxs)("li",{className:"mb-1",children:[(0,n.jsxs)("span",{className:"font-semibold",children:[e.from," → ",e.to]}),(0,n.jsxs)("span",{className:"ml-2 text-blue-600",children:[e.time.toFixed(2),"s"]}),a&&(0,n.jsxs)("span",{className:"ml-2 text-xs ".concat(s?"text-green-600 font-bold":"text-green-600"),children:["(Best: ",a.time.toFixed(2),"s",s?" - New PB!":"",")"]})]},t)})]})]}),(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)("p",{className:"text-sm font-semibold mb-1",children:"Best Segment Times"}),(0,n.jsxs)("ol",{className:"text-xs",children:[0===p.length&&(0,n.jsx)("li",{className:"text-muted-foreground",children:"No best segments yet."}),p.map((e,t)=>(0,n.jsxs)("li",{className:"mb-1",children:[(0,n.jsxs)("span",{className:"font-semibold",children:[e.from," → ",e.to]}),(0,n.jsxs)("span",{className:"ml-2 text-green-600",children:[e.time.toFixed(2),"s"]})]},t))]})]})]}):(0,n.jsx)("p",{className:"text-muted-foreground",children:"Locating..."})})]}),(0,n.jsx)("div",{className:"md:col-span-2 h-full min-h-0 flex-1 rounded-md overflow-hidden border",ref:e})]})]})}},7815:function(e,t,a){a.d(t,{Ol:function(){return o},Zb:function(){return l},aY:function(){return c},ll:function(){return i}});var n=a(3827),s=a(4090),r=a(1657);let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});l.displayName="Card";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",a),...s})});o.displayName="CardHeader";let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("h3",{ref:t,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});i.displayName="CardTitle",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("p",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",a),...s})}).displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",a),...s})});c.displayName="CardContent",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",a),...s})}).displayName="CardFooter"},1657:function(e,t,a){a.d(t,{cn:function(){return r}});var n=a(3167),s=a(1367);function r(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.m6)((0,n.W)(t))}}}]);