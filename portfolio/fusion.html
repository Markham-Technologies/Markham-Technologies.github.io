<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/638176d28ab44cfa.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-52260ed83fd89f9a.js"/><script src="/_next/static/chunks/fd9d1056-9e191f0896c1d560.js" async=""></script><script src="/_next/static/chunks/117-d5c8b1ed67c91cdf.js" async=""></script><script src="/_next/static/chunks/main-app-2bbbb2701f5d1bf1.js" async=""></script><script src="/_next/static/chunks/37-5b5fc7493c001178.js" async=""></script><script src="/_next/static/chunks/878-2cf370d6c0c8b36d.js" async=""></script><script src="/_next/static/chunks/220-ab6eecfb3bb34b8e.js" async=""></script><script src="/_next/static/chunks/app/portfolio/fusion/page-6dcb93d206ad6245.js" async=""></script><script src="/_next/static/chunks/972-6f03597f20397ce5.js" async=""></script><script src="/_next/static/chunks/332-81f647e1733b1ce9.js" async=""></script><script src="/_next/static/chunks/app/layout-0a7e37aae0ba3375.js" async=""></script><title>Ford Fusion Hacking</title><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="min-h-screen bg-background font-sans antialiased __variable_e8ce0c"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&false)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}else{c.add('dark')}if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'dark'}catch(e){}}()</script><div vaul-drawer-wrapper=""><div class="relative flex min-h-screen flex-col bg-background"><header class="sticky top-0 z-50 w-full border-b border-border/40 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60"><div class="container flex h-14 max-w-screen-2xl items-center"><nav aria-label="Main" data-orientation="horizontal" dir="ltr" class="relative z-10 flex max-w-max flex-1 items-center justify-center"><div style="position:relative"><ul data-orientation="horizontal" class="group flex flex-1 list-none items-center justify-center space-x-1" dir="ltr"><li><a class="group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50" href="/" data-radix-collection-item="">Home</a></li><li><button id="radix-:R6kq:-trigger-radix-:R9mkq:" data-state="closed" aria-expanded="false" aria-controls="radix-:R6kq:-content-radix-:R9mkq:" class="group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50 group" data-radix-collection-item="">Contact<!-- --> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180" aria-hidden="true"><path d="m6 9 6 6 6-6"></path></svg></button></li><li><button id="radix-:R6kq:-trigger-radix-:Rdmkq:" data-state="closed" aria-expanded="false" aria-controls="radix-:R6kq:-content-radix-:Rdmkq:" class="group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50 group" data-radix-collection-item="">Portfolio<!-- --> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180" aria-hidden="true"><path d="m6 9 6 6 6-6"></path></svg></button></li><li><a class="group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50" href="/ourTeam" data-radix-collection-item="">Our Team</a></li><li><a class="group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50" href="https://c.xkcd.com/random/comic/" data-radix-collection-item="">XKCD</a></li></ul></div><div class="absolute left-0 top-full flex justify-center"></div></nav></div></header><main class="flex-1"><div style="background-image:url(&quot;./bg.jpg&quot;);background-size:cover" class="bg-cover min-h-screen flex justify-center items-center py-12 px-4"><div class="container mx-auto text-white max-w-3xl"><header class="text-center mb-12"><h1 class="text-5xl font-extrabold mb-4">Hacking a 2010 Ford Fusion</h1><p class="text-xl text-gray-300 max-w-lg mx-auto">Join Peter Markham on an in-depth journey on vehicle analysis, reverse engineering, and using this information to our advantage.</p></header><div class="rounded-lg border text-card-foreground mb-12 bg-gray-800 bg-opacity-90 shadow-lg"><div class="flex flex-col space-y-1.5 p-6"><h3 class="tracking-tight text-3xl font-bold">Introduction</h3></div><div class="p-6 pt-0"><p class="text-white text-1xl whitespace-pre-line">As a wise man once said: &quot;Car security research is interesting for a general audience because most people have cars and understand the inherent dangers of an attacker gaining control of their vehicle.&quot;
            
            This is true for myself. Shortly after buying my first car I found my head underneath it; partly because a 10 year old car has a quite a few quirks and faults that need fixing.
            
            I have spent bits of my time over the two years poking around in my car and finding out what it can do. Unlike Dr. Charlie Miller, I don&#x27;t have a budget, or really any time. I&#x27;m also not fuelling a wider academic research, simply building my skills and relieving my interest. With that being said, lets begin.</p></div></div><div class="rounded-lg border text-card-foreground mb-12 bg-gray-800 bg-opacity-90 shadow-lg"><div class="flex flex-col space-y-1.5 p-6"><h3 class="tracking-tight text-3xl font-bold">The car</h3></div><div class="p-6 pt-0"><p class="text-white text-1xl whitespace-pre-line">I&#x27;m not going to bore you with the details. Below are some pictures of a Ford Fusion in admittedly better condition than mine. It&#x27;s not a showstopper, which means it&#x27;s the perfect first car.</p><div class="relative my-4 mx-10 rounded-lg shadow-lg" role="region" aria-roledescription="carousel"><div class="overflow-hidden"><div class="flex -ml-4"><div role="group" aria-roledescription="slide" class="min-w-0 shrink-0 grow-0 basis-full pl-4"><img alt="The car image 1" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="w-full h-auto" style="color:transparent" src="/Fusion1.jpg"/></div><div role="group" aria-roledescription="slide" class="min-w-0 shrink-0 grow-0 basis-full pl-4"><img alt="The car image 2" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="w-full h-auto" style="color:transparent" src="/Fusion3.jpg"/></div><div role="group" aria-roledescription="slide" class="min-w-0 shrink-0 grow-0 basis-full pl-4"><img alt="The car image 3" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="w-full h-auto" style="color:transparent" src="/Fusion2.jpg"/></div></div></div><button class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground absolute h-8 w-8 rounded-full -left-12 top-1/2 -translate-y-1/2" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left h-4 w-4"><path d="m12 19-7-7 7-7"></path><path d="M19 12H5"></path></svg><span class="sr-only">Previous slide</span></button><button class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground absolute h-8 w-8 rounded-full -right-12 top-1/2 -translate-y-1/2" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-right h-4 w-4"><path d="M5 12h14"></path><path d="m12 5 7 7-7 7"></path></svg><span class="sr-only">Next slide</span></button></div></div></div><div class="rounded-lg border text-card-foreground mb-12 bg-gray-800 bg-opacity-90 shadow-lg"><div class="flex flex-col space-y-1.5 p-6"><h3 class="tracking-tight text-3xl font-bold">Item Definition</h3></div><div class="p-6 pt-0"><p class="text-white text-1xl whitespace-pre-line">The Fusion is an incredibly simple car. It holds only a single CAN bus, unlike the higher trim varients. All components are connected to a 500k/bit HS-CAN without a gateway.
            
• The Powertrain Control Module (PCM) manages the engine and emissions functions. Peugeot designed the Duratorq 414, so there is a reasonable chance they had involvement with the PCM.
• The Anti-lock Braking System (ABS) manages the real-time wheel speed and braking actuation.
• The Instrument Cluster (IPK) displays diagnostic, time, vehicle range, speedometer and tachometer data. That&#x27;s it. No Radio information, no vehicle controls besides resetting the trip mileage. It&#x27;s basic.
• The Radio (RADIO) plays music. It has no Bluetooth, call, cellular, climate control, or really any functionality besides playing music.
• The Body Control Module (BCM) manages diagnostics and vehicle response, and controls vehicle lighting, central locking, and possibly power windows.

This leaves a problem. All attack vectors must have physical access (unless you can do something really clever with AM/FM radio waves).
</p><div class="relative my-4 mx-10 rounded-lg shadow-lg" role="region" aria-roledescription="carousel"><div class="overflow-hidden"><div class="flex -ml-4"><div role="group" aria-roledescription="slide" class="min-w-0 shrink-0 grow-0 basis-full pl-4"><img alt="Item Definition image 1" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="w-full h-auto" style="color:transparent" src="/Fusion_CAN.png"/></div></div></div></div></div></div><div class="rounded-lg border text-card-foreground mb-12 bg-gray-800 bg-opacity-90 shadow-lg"><div class="flex flex-col space-y-1.5 p-6"><h3 class="tracking-tight text-3xl font-bold">Gaining access</h3></div><div class="p-6 pt-0"><p class="text-white text-1xl whitespace-pre-line">The Fusion is thankfully modern enough to have remote central locking. That means a lockpick isn&#x27;t the only method of breaking into the car. The Ford Fusion has rolling keys, that means every a key cannot be used more than once. Regardless, it&#x27;s susceptible to key jam cloning.
            
This was partically demonstrated using a Flipper Zero, which when replying an unused key would unlock the car. Ford has an interesting security mechanism in which if it sees an old signal more than once it will disable RFID unlocking. This could be leveraged for an interesting Denial of Service attack. Access can be restored by disconnecting and reconnecting the 12V battery.</p><div class="relative my-4 mx-10 rounded-lg shadow-lg" role="region" aria-roledescription="carousel"><div class="overflow-hidden"><div class="flex -ml-4"><div role="group" aria-roledescription="slide" class="min-w-0 shrink-0 grow-0 basis-full pl-4"><img alt="Gaining access image 1" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="w-full h-auto" style="color:transparent" src="/flipperZero.jpg"/></div></div></div></div></div></div><div class="rounded-lg border text-card-foreground mb-12 bg-gray-800 bg-opacity-90 shadow-lg"><div class="flex flex-col space-y-1.5 p-6"><h3 class="tracking-tight text-3xl font-bold">The CAN bus</h3></div><div class="p-6 pt-0"><p class="text-white text-1xl whitespace-pre-line">Sadly, Ford doesn&#x27;t leave Deutsch DT Series 3-Way Connectors all around their cars. This leaves a few options:
• Tapping directly (splicing) into the CAN bus at a point of our choosing along one of the harnesses.
• Splicing/doubling up at one of the pins that connects to an ECU
• Plugging in to the OBD-II port. Don&#x27;t forget this car is gateway free!

Without a gateway in place between the OBD-II port and the entire CAN bus we&#x27;re able to recieve (and send) any messages we please. I didn&#x27;t actually end up plugging into the OBD-II port during initial testing, as wiring a plug takes time and might have been pointless if it didn&#x27;t work. Instead, I used crocodile clips to slice through the wire insulation and clipped these to my CAN transciever.
            </p><div class="relative my-4 mx-10 rounded-lg shadow-lg" role="region" aria-roledescription="carousel"><div class="overflow-hidden"><div class="flex -ml-4"><div role="group" aria-roledescription="slide" class="min-w-0 shrink-0 grow-0 basis-full pl-4"><img alt="The CAN bus image 1" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="w-full h-auto" style="color:transparent" src="/OBDCrocodile.png"/></div></div></div></div></div></div><div class="rounded-lg border text-card-foreground mb-12 bg-gray-800 bg-opacity-90 shadow-lg"><div class="flex flex-col space-y-1.5 p-6"><h3 class="tracking-tight text-3xl font-bold">The CAN transciever</h3></div><div class="p-6 pt-0"><p class="text-white text-1xl whitespace-pre-line"> I own a few CAN transcievers. One is the Waveshare 2-CH CAN HAT, which is supported by Linux&#x27;s socketcan implementation, which allows me to use nearly every CAN library in existence. My personal favourite is &lt;python-can className=&quot;
            
Alternatively, I also own a Waveshare USB-CAN-A, which is a cheap CAN-to-Serial converter. The serial implementation isn&#x27;t supported by any libraries. As I find the device conveniant, I actually wrote my own module for it in python-can. It&#x27;s not finished and doesn&#x27;t support everything it should do to be released to python-can, like multipacket messages or CAN-FD, but it works enough for my use case.

I used both of these devices interchangeably during the reverse engineering, before settling on the 2-CH CAN HAT, which was used as part of my ClusterCAN Instrument Cluster project.
            </p><div class="relative my-4 mx-10 rounded-lg shadow-lg" role="region" aria-roledescription="carousel"><div class="overflow-hidden"><div class="flex -ml-4"><div role="group" aria-roledescription="slide" class="min-w-0 shrink-0 grow-0 basis-full pl-4"><img alt="The CAN transciever image 1" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="w-full h-auto" style="color:transparent" src="/2-CH-CAN-HAT.png"/></div><div role="group" aria-roledescription="slide" class="min-w-0 shrink-0 grow-0 basis-full pl-4"><img alt="The CAN transciever image 2" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="w-full h-auto" style="color:transparent" src="/USB-CAN-A.png"/></div></div></div><button class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground absolute h-8 w-8 rounded-full -left-12 top-1/2 -translate-y-1/2" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left h-4 w-4"><path d="m12 19-7-7 7-7"></path><path d="M19 12H5"></path></svg><span class="sr-only">Previous slide</span></button><button class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground absolute h-8 w-8 rounded-full -right-12 top-1/2 -translate-y-1/2" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-right h-4 w-4"><path d="M5 12h14"></path><path d="m12 5 7 7-7 7"></path></svg><span class="sr-only">Next slide</span></button></div></div></div><footer class="text-center mt-12"><h2 class="text-3xl font-semibold mb-4">To be continued</h2><p class="text-gray-300 text-lg max-w-lg mx-auto">My time is limited at the moment, but rest assured, I&#x27;ve not finished this blog. Check back later for the finished article.</p></footer></div></div></main></div></div><script src="/_next/static/chunks/webpack-52260ed83fd89f9a.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/638176d28ab44cfa.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"2:I[2846,[],\"\"]\n4:I[6902,[\"37\",\"static/chunks/37-5b5fc7493c001178.js\",\"878\",\"static/chunks/878-2cf370d6c0c8b36d.js\",\"220\",\"static/chunks/220-ab6eecfb3bb34b8e.js\",\"64\",\"static/chunks/app/portfolio/fusion/page-6dcb93d206ad6245.js\"],\"Carousel\"]\n5:I[6902,[\"37\",\"static/chunks/37-5b5fc7493c001178.js\",\"878\",\"static/chunks/878-2cf370d6c0c8b36d.js\",\"220\",\"static/chunks/220-ab6eecfb3bb34b8e.js\",\"64\",\"static/chunks/app/portfolio/fusion/page-6dcb93d206ad6245.js\"],\"CarouselContent\"]\n6:I[6902,[\"37\",\"static/chunks/37-5b5fc7493c001178.js\",\"878\",\"static/chunks/878-2cf370d6c0c8b36d.js\",\"220\",\"static/chunks/220-ab6eecfb3bb34b8e.js\",\"64\",\"static/chunks/app/portfolio/fusion/page-6dcb93d206ad6245.js\"],\"CarouselItem\"]\n7:I[5878,[\"37\",\"static/chunks/37-5b5fc7493c001178.js\",\"878\",\"static/chunks/878-2cf370d6c0c8b36d.js\",\"220\",\"static/chunks/220-ab6eecfb3bb34b8e.js\",\"64\",\"static/chunks/app/portfolio/fusion/page-6dcb93d206ad6245.js\"],\"Image\"]\n8:I[6902,[\"37\",\"static/chunks/37-5b5fc7493c001178.js\",\"878\",\"static/chunks/878-2cf370d6c0c8b36d.js\",\"220\",\"static/chunks/220-ab6eecfb3bb34b8e.js\",\"64\",\"static/chunks/app/portfolio/fusion/page-6dcb93d206ad6245.js\"],\"CarouselPrevious\"]\n9:I[6902,[\"37\",\"static/chunks/37-5b5fc7493c001178.js\",\"878\",\"static/chunks/878-2cf370d6c0c8b36d.js\",\"220\",\"static/chunks/220-ab6eecfb3bb34b8e.js\",\"64\",\"static/chunks/app/portfolio/fusion/page-6dcb93d206ad6245.js\"],\"CarouselNext\"]\nb:I[4707,[],\"\"]\nc:I[6423,[],\"\"]\nd:I[1455,[\"37\",\"static/chunks/37-5b5fc7493c001178.js\",\"972\",\"static/chunks/972-6f03597f20397ce5.js\",\"332\",\"static/chunks/332-81f647e1733b1ce9.js\",\"185\",\"static/chunks/app/layout-0a7e37aae0ba3375.js\"],\"default\",1]\nf:I[1060,[],\"\"]\na:T453,The Fusion is an incredibly simple car. It holds only a single CAN bus, unlike the higher trim varients. All components are connected to a 500k/bit HS-CAN without a gateway.\n            \n• The Powertrain Control Module (PCM) manages the engine and emissions functions. Peugeot designed the Duratorq 414, so there is a reasonable chance they had involvement with the PCM.\n• The Anti-lo"])</script><script>self.__next_f.push([1,"ck Braking System (ABS) manages the real-time wheel speed and braking actuation.\n• The Instrument Cluster (IPK) displays diagnostic, time, vehicle range, speedometer and tachometer data. That's it. No Radio information, no vehicle controls besides resetting the trip mileage. It's basic.\n• The Radio (RADIO) plays music. It has no Bluetooth, call, cellular, climate control, or really any functionality besides playing music.\n• The Body Control Module (BCM) manages diagnostics and vehicle response, and controls vehicle lighting, central locking, and possibly power windows.\n\nThis leaves a problem. All attack vectors must have physical access (unless you can do something really clever with AM/FM radio waves).\n10:[]\n"])</script><script>self.__next_f.push([1,"0:[\"$\",\"$L2\",null,{\"buildId\":\"tnDR2ULSXelq9mQXaUvhv\",\"assetPrefix\":\"\",\"urlParts\":[\"\",\"portfolio\",\"fusion\"],\"initialTree\":[\"\",{\"children\":[\"portfolio\",{\"children\":[\"fusion\",{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"portfolio\",{\"children\":[\"fusion\",{\"children\":[\"__PAGE__\",{},[[\"$L3\",[\"$\",\"div\",null,{\"style\":{\"backgroundImage\":\"url(\\\"./bg.jpg\\\")\",\"backgroundSize\":\"cover\"},\"className\":\"bg-cover min-h-screen flex justify-center items-center py-12 px-4\",\"children\":[\"$\",\"div\",null,{\"className\":\"container mx-auto text-white max-w-3xl\",\"children\":[[\"$\",\"title\",null,{\"children\":\"Ford Fusion Hacking\"}],[\"$\",\"header\",null,{\"className\":\"text-center mb-12\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-5xl font-extrabold mb-4\",\"children\":\"Hacking a 2010 Ford Fusion\"}],[\"$\",\"p\",null,{\"className\":\"text-xl text-gray-300 max-w-lg mx-auto\",\"children\":\"Join Peter Markham on an in-depth journey on vehicle analysis, reverse engineering, and using this information to our advantage.\"}]]}],[[\"$\",\"div\",null,{\"className\":\"rounded-lg border text-card-foreground mb-12 bg-gray-800 bg-opacity-90 shadow-lg\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-col space-y-1.5 p-6\",\"children\":[\"$\",\"h3\",null,{\"className\":\"tracking-tight text-3xl font-bold\",\"children\":\"Introduction\"}]}],[\"$\",\"div\",null,{\"className\":\"p-6 pt-0\",\"children\":[[\"$\",\"p\",null,{\"className\":\"text-white text-1xl whitespace-pre-line\",\"children\":\"As a wise man once said: \\\"Car security research is interesting for a general audience because most people have cars and understand the inherent dangers of an attacker gaining control of their vehicle.\\\"\\n            \\n            This is true for myself. Shortly after buying my first car I found my head underneath it; partly because a 10 year old car has a quite a few quirks and faults that need fixing.\\n            \\n            I have spent bits of my time over the two years poking around in my car and finding out what it can do. Unlike Dr. Charlie Miller, I don't have a budget, or really any time. I'm also not fuelling a wider academic research, simply building my skills and relieving my interest. With that being said, lets begin.\"}],false]}]]}],[\"$\",\"div\",null,{\"className\":\"rounded-lg border text-card-foreground mb-12 bg-gray-800 bg-opacity-90 shadow-lg\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-col space-y-1.5 p-6\",\"children\":[\"$\",\"h3\",null,{\"className\":\"tracking-tight text-3xl font-bold\",\"children\":\"The car\"}]}],[\"$\",\"div\",null,{\"className\":\"p-6 pt-0\",\"children\":[[\"$\",\"p\",null,{\"className\":\"text-white text-1xl whitespace-pre-line\",\"children\":\"I'm not going to bore you with the details. Below are some pictures of a Ford Fusion in admittedly better condition than mine. It's not a showstopper, which means it's the perfect first car.\"}],[\"$\",\"$L4\",null,{\"className\":\"my-4 mx-10 rounded-lg shadow-lg\",\"children\":[[\"$\",\"$L5\",null,{\"children\":[[\"$\",\"$L6\",\"0\",{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/Fusion1.jpg\",\"alt\":\"The car image 1\",\"width\":0,\"height\":0,\"className\":\"w-full h-auto\"}]}],[\"$\",\"$L6\",\"1\",{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/Fusion3.jpg\",\"alt\":\"The car image 2\",\"width\":0,\"height\":0,\"className\":\"w-full h-auto\"}]}],[\"$\",\"$L6\",\"2\",{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/Fusion2.jpg\",\"alt\":\"The car image 3\",\"width\":0,\"height\":0,\"className\":\"w-full h-auto\"}]}]]}],[[\"$\",\"$L8\",null,{}],[\"$\",\"$L9\",null,{}]]]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"rounded-lg border text-card-foreground mb-12 bg-gray-800 bg-opacity-90 shadow-lg\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-col space-y-1.5 p-6\",\"children\":[\"$\",\"h3\",null,{\"className\":\"tracking-tight text-3xl font-bold\",\"children\":\"Item Definition\"}]}],[\"$\",\"div\",null,{\"className\":\"p-6 pt-0\",\"children\":[[\"$\",\"p\",null,{\"className\":\"text-white text-1xl whitespace-pre-line\",\"children\":\"$a\"}],[\"$\",\"$L4\",null,{\"className\":\"my-4 mx-10 rounded-lg shadow-lg\",\"children\":[[\"$\",\"$L5\",null,{\"children\":[[\"$\",\"$L6\",\"0\",{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/Fusion_CAN.png\",\"alt\":\"Item Definition image 1\",\"width\":0,\"height\":0,\"className\":\"w-full h-auto\"}]}]]}],false]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"rounded-lg border text-card-foreground mb-12 bg-gray-800 bg-opacity-90 shadow-lg\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-col space-y-1.5 p-6\",\"children\":[\"$\",\"h3\",null,{\"className\":\"tracking-tight text-3xl font-bold\",\"children\":\"Gaining access\"}]}],[\"$\",\"div\",null,{\"className\":\"p-6 pt-0\",\"children\":[[\"$\",\"p\",null,{\"className\":\"text-white text-1xl whitespace-pre-line\",\"children\":\"The Fusion is thankfully modern enough to have remote central locking. That means a lockpick isn't the only method of breaking into the car. The Ford Fusion has rolling keys, that means every a key cannot be used more than once. Regardless, it's susceptible to key jam cloning.\\n            \\nThis was partically demonstrated using a Flipper Zero, which when replying an unused key would unlock the car. Ford has an interesting security mechanism in which if it sees an old signal more than once it will disable RFID unlocking. This could be leveraged for an interesting Denial of Service attack. Access can be restored by disconnecting and reconnecting the 12V battery.\"}],[\"$\",\"$L4\",null,{\"className\":\"my-4 mx-10 rounded-lg shadow-lg\",\"children\":[[\"$\",\"$L5\",null,{\"children\":[[\"$\",\"$L6\",\"0\",{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/flipperZero.jpg\",\"alt\":\"Gaining access image 1\",\"width\":0,\"height\":0,\"className\":\"w-full h-auto\"}]}]]}],false]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"rounded-lg border text-card-foreground mb-12 bg-gray-800 bg-opacity-90 shadow-lg\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-col space-y-1.5 p-6\",\"children\":[\"$\",\"h3\",null,{\"className\":\"tracking-tight text-3xl font-bold\",\"children\":\"The CAN bus\"}]}],[\"$\",\"div\",null,{\"className\":\"p-6 pt-0\",\"children\":[[\"$\",\"p\",null,{\"className\":\"text-white text-1xl whitespace-pre-line\",\"children\":\"Sadly, Ford doesn't leave Deutsch DT Series 3-Way Connectors all around their cars. This leaves a few options:\\n• Tapping directly (splicing) into the CAN bus at a point of our choosing along one of the harnesses.\\n• Splicing/doubling up at one of the pins that connects to an ECU\\n• Plugging in to the OBD-II port. Don't forget this car is gateway free!\\n\\nWithout a gateway in place between the OBD-II port and the entire CAN bus we're able to recieve (and send) any messages we please. I didn't actually end up plugging into the OBD-II port during initial testing, as wiring a plug takes time and might have been pointless if it didn't work. Instead, I used crocodile clips to slice through the wire insulation and clipped these to my CAN transciever.\\n            \"}],[\"$\",\"$L4\",null,{\"className\":\"my-4 mx-10 rounded-lg shadow-lg\",\"children\":[[\"$\",\"$L5\",null,{\"children\":[[\"$\",\"$L6\",\"0\",{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/OBDCrocodile.png\",\"alt\":\"The CAN bus image 1\",\"width\":0,\"height\":0,\"className\":\"w-full h-auto\"}]}]]}],false]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"rounded-lg border text-card-foreground mb-12 bg-gray-800 bg-opacity-90 shadow-lg\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-col space-y-1.5 p-6\",\"children\":[\"$\",\"h3\",null,{\"className\":\"tracking-tight text-3xl font-bold\",\"children\":\"The CAN transciever\"}]}],[\"$\",\"div\",null,{\"className\":\"p-6 pt-0\",\"children\":[[\"$\",\"p\",null,{\"className\":\"text-white text-1xl whitespace-pre-line\",\"children\":\" I own a few CAN transcievers. One is the Waveshare 2-CH CAN HAT, which is supported by Linux's socketcan implementation, which allows me to use nearly every CAN library in existence. My personal favourite is \u003cpython-can className=\\\"\\n            \\nAlternatively, I also own a Waveshare USB-CAN-A, which is a cheap CAN-to-Serial converter. The serial implementation isn't supported by any libraries. As I find the device conveniant, I actually wrote my own module for it in python-can. It's not finished and doesn't support everything it should do to be released to python-can, like multipacket messages or CAN-FD, but it works enough for my use case.\\n\\nI used both of these devices interchangeably during the reverse engineering, before settling on the 2-CH CAN HAT, which was used as part of my ClusterCAN Instrument Cluster project.\\n            \"}],[\"$\",\"$L4\",null,{\"className\":\"my-4 mx-10 rounded-lg shadow-lg\",\"children\":[[\"$\",\"$L5\",null,{\"children\":[[\"$\",\"$L6\",\"0\",{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/2-CH-CAN-HAT.png\",\"alt\":\"The CAN transciever image 1\",\"width\":0,\"height\":0,\"className\":\"w-full h-auto\"}]}],[\"$\",\"$L6\",\"1\",{\"children\":[\"$\",\"$L7\",null,{\"src\":\"/USB-CAN-A.png\",\"alt\":\"The CAN transciever image 2\",\"width\":0,\"height\":0,\"className\":\"w-full h-auto\"}]}]]}],[[\"$\",\"$L8\",null,{}],[\"$\",\"$L9\",null,{}]]]}]]}]]}]],[\"$\",\"footer\",null,{\"className\":\"text-center mt-12\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"text-3xl font-semibold mb-4\",\"children\":\"To be continued\"}],[\"$\",\"p\",null,{\"className\":\"text-gray-300 text-lg max-w-lg mx-auto\",\"children\":\"My time is limited at the moment, but rest assured, I've not finished this blog. Check back later for the finished article.\"}]]}]]}]}],null],null],null]},[null,[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"portfolio\",\"children\",\"fusion\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[null,[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"portfolio\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/638176d28ab44cfa.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$Ld\",null,{\"children\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[]}],\"params\":{}}]],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$Le\"],\"globalErrorComponent\":\"$f\",\"missingSlots\":\"$W10\"}]\n"])</script><script>self.__next_f.push([1,"e:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}]]\n3:null\n"])</script></body></html>