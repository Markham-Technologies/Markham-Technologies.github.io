2:I[8870,["150","static/chunks/150-bca498b1a7c627aa.js","749","static/chunks/749-84c9ebb6974cf9c9.js","611","static/chunks/611-fbfffc03d440a8eb.js","64","static/chunks/app/portfolio/fusion/page-c2b710a00554f397.js"],"Carousel"]
3:I[8870,["150","static/chunks/150-bca498b1a7c627aa.js","749","static/chunks/749-84c9ebb6974cf9c9.js","611","static/chunks/611-fbfffc03d440a8eb.js","64","static/chunks/app/portfolio/fusion/page-c2b710a00554f397.js"],"CarouselContent"]
4:I[8870,["150","static/chunks/150-bca498b1a7c627aa.js","749","static/chunks/749-84c9ebb6974cf9c9.js","611","static/chunks/611-fbfffc03d440a8eb.js","64","static/chunks/app/portfolio/fusion/page-c2b710a00554f397.js"],"CarouselItem"]
5:I[1749,["150","static/chunks/150-bca498b1a7c627aa.js","749","static/chunks/749-84c9ebb6974cf9c9.js","611","static/chunks/611-fbfffc03d440a8eb.js","64","static/chunks/app/portfolio/fusion/page-c2b710a00554f397.js"],"Image"]
6:I[8870,["150","static/chunks/150-bca498b1a7c627aa.js","749","static/chunks/749-84c9ebb6974cf9c9.js","611","static/chunks/611-fbfffc03d440a8eb.js","64","static/chunks/app/portfolio/fusion/page-c2b710a00554f397.js"],"CarouselPrevious"]
7:I[8870,["150","static/chunks/150-bca498b1a7c627aa.js","749","static/chunks/749-84c9ebb6974cf9c9.js","611","static/chunks/611-fbfffc03d440a8eb.js","64","static/chunks/app/portfolio/fusion/page-c2b710a00554f397.js"],"CarouselNext"]
9:I[5613,[],""]
a:I[1778,[],""]
b:I[3365,["150","static/chunks/150-bca498b1a7c627aa.js","250","static/chunks/250-ba2aaeb0bfb8ff0a.js","180","static/chunks/180-9fb15b5313d1bfd2.js","185","static/chunks/app/layout-f94ee8e5a8fdebb1.js"],""]
8:T453,The Fusion is an incredibly simple car. It holds only a single CAN bus, unlike the higher trim varients. All components are connected to a 500k/bit HS-CAN without a gateway.
            
• The Powertrain Control Module (PCM) manages the engine and emissions functions. Peugeot designed the Duratorq 414, so there is a reasonable chance they had involvement with the PCM.
• The Anti-lock Braking System (ABS) manages the real-time wheel speed and braking actuation.
• The Instrument Cluster (IPK) displays diagnostic, time, vehicle range, speedometer and tachometer data. That's it. No Radio information, no vehicle controls besides resetting the trip mileage. It's basic.
• The Radio (RADIO) plays music. It has no Bluetooth, call, cellular, climate control, or really any functionality besides playing music.
• The Body Control Module (BCM) manages diagnostics and vehicle response, and controls vehicle lighting, central locking, and possibly power windows.

This leaves a problem. All attack vectors must have physical access (unless you can do something really clever with AM/FM radio waves).
0:["0g6raHft6UoZyRfkwlCga",[[["",{"children":["portfolio",{"children":["fusion",{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",{"children":["portfolio",{"children":["fusion",{"children":["__PAGE__",{},["$L1",["$","div",null,{"style":{"backgroundImage":"url(\"./bg.jpg\")","backgroundSize":"cover"},"className":"bg-cover min-h-screen flex justify-center items-center py-12 px-4","children":["$","div",null,{"className":"container mx-auto text-white max-w-3xl","children":[["$","title",null,{"children":"Ford Fusion Hacking"}],["$","header",null,{"className":"text-center mb-12","children":[["$","h1",null,{"className":"text-5xl font-extrabold mb-4","children":"Hacking a 2010 Ford Fusion"}],["$","p",null,{"className":"text-xl text-gray-300 max-w-lg mx-auto","children":"Join Peter Markham on an in-depth journey on vehicle analysis, reverse engineering, and using this information to our advantage."}]]}],[["$","div",null,{"className":"rounded-lg border text-card-foreground mb-12 bg-gray-800 bg-opacity-90 shadow-lg","children":[["$","div",null,{"className":"flex flex-col space-y-1.5 p-6","children":["$","h3",null,{"className":"tracking-tight text-3xl font-bold","children":"Introduction"}]}],["$","div",null,{"className":"p-6 pt-0","children":[["$","p",null,{"className":"text-white text-1xl whitespace-pre-line","children":"As a wise man once said: \"Car security research is interesting for a general audience because most people have cars and understand the inherent dangers of an attacker gaining control of their vehicle.\"\n            \n            This is true for myself. Shortly after buying my first car I found my head underneath it; partly because a 10 year old car has a quite a few quirks and faults that need fixing.\n            \n            I have spent bits of my time over the two years poking around in my car and finding out what it can do. Unlike Dr. Charlie Miller, I don't have a budget, or really any time. I'm also not fuelling a wider academic research, simply building my skills and relieving my interest. With that being said, lets begin."}],false]}]]}],["$","div",null,{"className":"rounded-lg border text-card-foreground mb-12 bg-gray-800 bg-opacity-90 shadow-lg","children":[["$","div",null,{"className":"flex flex-col space-y-1.5 p-6","children":["$","h3",null,{"className":"tracking-tight text-3xl font-bold","children":"The car"}]}],["$","div",null,{"className":"p-6 pt-0","children":[["$","p",null,{"className":"text-white text-1xl whitespace-pre-line","children":"I'm not going to bore you with the details. Below are some pictures of a Ford Fusion in admittedly better condition than mine. It's not a showstopper, which means it's the perfect first car."}],["$","$L2",null,{"className":"my-4 mx-10 rounded-lg shadow-lg","children":[["$","$L3",null,{"children":[["$","$L4","0",{"children":["$","$L5",null,{"src":"/Fusion1.jpg","alt":"The car image 1","width":0,"height":0,"className":"w-full h-auto"}]}],["$","$L4","1",{"children":["$","$L5",null,{"src":"/Fusion3.jpg","alt":"The car image 2","width":0,"height":0,"className":"w-full h-auto"}]}],["$","$L4","2",{"children":["$","$L5",null,{"src":"/Fusion2.jpg","alt":"The car image 3","width":0,"height":0,"className":"w-full h-auto"}]}]]}],[["$","$L6",null,{}],["$","$L7",null,{}]]]}]]}]]}],["$","div",null,{"className":"rounded-lg border text-card-foreground mb-12 bg-gray-800 bg-opacity-90 shadow-lg","children":[["$","div",null,{"className":"flex flex-col space-y-1.5 p-6","children":["$","h3",null,{"className":"tracking-tight text-3xl font-bold","children":"Item Definition"}]}],["$","div",null,{"className":"p-6 pt-0","children":[["$","p",null,{"className":"text-white text-1xl whitespace-pre-line","children":"$8"}],["$","$L2",null,{"className":"my-4 mx-10 rounded-lg shadow-lg","children":[["$","$L3",null,{"children":[["$","$L4","0",{"children":["$","$L5",null,{"src":"/Fusion_CAN.png","alt":"Item Definition image 1","width":0,"height":0,"className":"w-full h-auto"}]}]]}],false]}]]}]]}],["$","div",null,{"className":"rounded-lg border text-card-foreground mb-12 bg-gray-800 bg-opacity-90 shadow-lg","children":[["$","div",null,{"className":"flex flex-col space-y-1.5 p-6","children":["$","h3",null,{"className":"tracking-tight text-3xl font-bold","children":"Gaining access"}]}],["$","div",null,{"className":"p-6 pt-0","children":[["$","p",null,{"className":"text-white text-1xl whitespace-pre-line","children":"The Fusion is thankfully modern enough to have remote central locking. That means a lockpick isn't the only method of breaking into the car. The Ford Fusion has rolling keys, that means every a key cannot be used more than once. Regardless, it's susceptible to key jam cloning.\n            \nThis was partically demonstrated using a Flipper Zero, which when replying an unused key would unlock the car. Ford has an interesting security mechanism in which if it sees an old signal more than once it will disable RFID unlocking. This could be leveraged for an interesting Denial of Service attack. Access can be restored by disconnecting and reconnecting the 12V battery."}],["$","$L2",null,{"className":"my-4 mx-10 rounded-lg shadow-lg","children":[["$","$L3",null,{"children":[["$","$L4","0",{"children":["$","$L5",null,{"src":"/flipperZero.jpg","alt":"Gaining access image 1","width":0,"height":0,"className":"w-full h-auto"}]}]]}],false]}]]}]]}],["$","div",null,{"className":"rounded-lg border text-card-foreground mb-12 bg-gray-800 bg-opacity-90 shadow-lg","children":[["$","div",null,{"className":"flex flex-col space-y-1.5 p-6","children":["$","h3",null,{"className":"tracking-tight text-3xl font-bold","children":"The CAN bus"}]}],["$","div",null,{"className":"p-6 pt-0","children":[["$","p",null,{"className":"text-white text-1xl whitespace-pre-line","children":"Sadly, Ford doesn't leave Deutsch DT Series 3-Way Connectors all around their cars. This leaves a few options:\n• Tapping directly (splicing) into the CAN bus at a point of our choosing along one of the harnesses.\n• Splicing/doubling up at one of the pins that connects to an ECU\n• Plugging in to the OBD-II port. Don't forget this car is gateway free!\n\nWithout a gateway in place between the OBD-II port and the entire CAN bus we're able to recieve (and send) any messages we please. I didn't actually end up plugging into the OBD-II port during initial testing, as wiring a plug takes time and might have been pointless if it didn't work. Instead, I used crocodile clips to slice through the wire insulation and clipped these to my CAN transciever.\n            "}],["$","$L2",null,{"className":"my-4 mx-10 rounded-lg shadow-lg","children":[["$","$L3",null,{"children":[["$","$L4","0",{"children":["$","$L5",null,{"src":"/OBDCrocodile.png","alt":"The CAN bus image 1","width":0,"height":0,"className":"w-full h-auto"}]}]]}],false]}]]}]]}],["$","div",null,{"className":"rounded-lg border text-card-foreground mb-12 bg-gray-800 bg-opacity-90 shadow-lg","children":[["$","div",null,{"className":"flex flex-col space-y-1.5 p-6","children":["$","h3",null,{"className":"tracking-tight text-3xl font-bold","children":"The CAN transciever"}]}],["$","div",null,{"className":"p-6 pt-0","children":[["$","p",null,{"className":"text-white text-1xl whitespace-pre-line","children":" I own a few CAN transcievers. One is the Waveshare 2-CH CAN HAT, which is supported by Linux's socketcan implementation, which allows me to use nearly every CAN library in existence. My personal favourite is <python-can className=\"\n            \nAlternatively, I also own a Waveshare USB-CAN-A, which is a cheap CAN-to-Serial converter. The serial implementation isn't supported by any libraries. As I find the device conveniant, I actually wrote my own module for it in python-can. It's not finished and doesn't support everything it should do to be released to python-can, like multipacket messages or CAN-FD, but it works enough for my use case.\n\nI used both of these devices interchangeably during the reverse engineering, before settling on the 2-CH CAN HAT, which was used as part of my ClusterCAN Instrument Cluster project.\n            "}],["$","$L2",null,{"className":"my-4 mx-10 rounded-lg shadow-lg","children":[["$","$L3",null,{"children":[["$","$L4","0",{"children":["$","$L5",null,{"src":"/2-CH-CAN-HAT.png","alt":"The CAN transciever image 1","width":0,"height":0,"className":"w-full h-auto"}]}],["$","$L4","1",{"children":["$","$L5",null,{"src":"/USB-CAN-A.png","alt":"The CAN transciever image 2","width":0,"height":0,"className":"w-full h-auto"}]}]]}],[["$","$L6",null,{}],["$","$L7",null,{}]]]}]]}]]}]],["$","footer",null,{"className":"text-center mt-12","children":[["$","h2",null,{"className":"text-3xl font-semibold mb-4","children":"To be continued"}],["$","p",null,{"className":"text-gray-300 text-lg max-w-lg mx-auto","children":"My time is limited at the moment, but rest assured, I've not finished this blog. Check back later for the finished article."}]]}]]}]}],null]]},["$","$L9",null,{"parallelRouterKey":"children","segmentPath":["children","portfolio","children","fusion","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$La",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]},["$","$L9",null,{"parallelRouterKey":"children","segmentPath":["children","portfolio","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$La",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]},[null,["$","$Lb",null,{"children":["$","$L9",null,{"parallelRouterKey":"children","segmentPath":["children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$La",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[],"styles":null}],"params":{}}],null]],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/04829192549a776e.css","precedence":"next","crossOrigin":""}]],"$Lc"]]]]
c:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}]]
1:null
